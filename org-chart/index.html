<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organizational Chart - Site-89</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800;900&family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">

  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/main.css">
  
  <!-- Theme System -->
  <script type="module">
    import { ThemeManager } from '/assets/js/theme.js';
    ThemeManager.init();
  </script>
  
  <style>
    .content {
      max-width: 1600px;
      margin: 0 auto;
      padding: 2rem;
    }

    .org-header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 2rem 0;
    }

    .org-header h1 {
      font-size: clamp(2rem, 5vw, 3rem);
      font-weight: 900;
      background: linear-gradient(135deg, var(--accent-mint), var(--accent-teal));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
    }

    .org-header p {
      font-size: 1.1rem;
      color: var(--text-light);
      opacity: 0.8;
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* Org Chart Container */
    .org-chart {
      position: relative;
      padding: 2rem 0;
    }

    /* SVG for lines */
    .org-chart-lines {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .org-chart-lines line {
      stroke: var(--accent-mint);
      stroke-width: 2;
      opacity: 0.3;
      transition: all 0.3s ease;
    }

    .org-chart-lines line.highlighted {
      stroke: var(--accent-mint);
      stroke-width: 4;
      opacity: 0.9;
      filter: drop-shadow(0 0 8px var(--accent-mint));
    }

    .org-chart-lines line.animated {
      stroke-dasharray: 10 5;
      animation: flowLine 1.5s linear infinite;
    }

    @keyframes flowLine {
      0% {
        stroke-dashoffset: 0;
      }
      100% {
        stroke-dashoffset: -15;
      }
    }

    /* Levels */
    .org-level {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 2rem;
      margin-bottom: 4rem;
      position: relative;
      z-index: 2;
      flex-wrap: wrap;
    }

    /* Position Classes */
    .org-position {
      background: var(--bg-card);
      border: 2px solid rgba(78, 250, 170, 0.2);
      border-radius: 12px;
      padding: 1.5rem;
      min-width: 220px;
      max-width: 280px;
      text-align: center;
      position: relative;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .org-position:hover {
      transform: translateY(-8px);
      border-color: var(--accent-mint);
      box-shadow: 0 12px 40px rgba(78, 250, 170, 0.3);
    }

    /* Position Styles by Type */
    .org-position.director {
      border-color: var(--accent-mint);
      background: linear-gradient(135deg, rgba(78, 250, 170, 0.1), var(--bg-card));
      box-shadow: 0 4px 20px rgba(78, 250, 170, 0.2);
    }

    .org-position.department {
      border-color: var(--accent-teal);
    }

    .org-position.division {
      border-color: rgba(78, 250, 170, 0.15);
      min-width: 180px;
      max-width: 220px;
      padding: 1.2rem;
    }

    /* Position Content */
    .position-icon {
      font-size: 2.5rem;
      color: var(--accent-mint);
      margin-bottom: 1rem;
    }

    .org-position.department .position-icon {
      color: var(--accent-teal);
    }

    .org-position.division .position-icon {
      font-size: 2rem;
      opacity: 0.7;
    }

    .position-title {
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--accent-mint);
      margin-bottom: 0.5rem;
      font-family: var(--font-head);
    }

    .org-position.department .position-title {
      color: var(--accent-teal);
    }

    .org-position.division .position-title {
      font-size: 1.1rem;
    }

    .position-name {
      font-size: 0.95rem;
      color: var(--text-light);
      opacity: 0.9;
      margin-bottom: 0.3rem;
      font-weight: 500;
    }

    .position-subtitle {
      font-size: 0.85rem;
      color: var(--muted);
      opacity: 0.7;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-family: var(--font-mono);
    }

    .position-badge {
      display: inline-block;
      background: rgba(78, 250, 170, 0.15);
      color: var(--accent-mint);
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.75rem;
      margin-top: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .org-position.department .position-badge {
      background: rgba(0, 163, 137, 0.15);
      color: var(--accent-teal);
    }

    /* Light Mode Adjustments */
    html[data-theme="light"] .org-position {
      background: #FFFFFF;
      border-color: #D0D0D0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    html[data-theme="light"] .org-position:hover {
      box-shadow: 0 12px 24px rgba(30, 155, 138, 0.2);
      border-color: #1E9B8A;
    }

    html[data-theme="light"] .org-position.director {
      border-color: #1E9B8A;
      background: linear-gradient(135deg, rgba(30, 155, 138, 0.08), #FFFFFF);
    }

    html[data-theme="light"] .org-position.department {
      border-color: #0D6E66;
    }

    html[data-theme="light"] .org-chart-lines line {
      stroke: #1E9B8A;
      opacity: 0.4;
    }

    html[data-theme="light"] .position-title {
      color: #1E9B8A;
    }

    html[data-theme="light"] .org-position.department .position-title {
      color: #0D6E66;
    }

    html[data-theme="light"] .position-icon {
      color: #1E9B8A;
    }

    html[data-theme="light"] .org-position.department .position-icon {
      color: #0D6E66;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .org-level {
        gap: 1.5rem;
      }

      .org-position {
        min-width: 180px;
        max-width: 220px;
      }
    }

    @media (max-width: 768px) {
      .content {
        padding: 1rem;
      }

      .org-level {
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .org-position {
        max-width: 100%;
        width: 100%;
      }

      .org-chart-lines {
        display: none;
      }
    }

    /* Legend */
    .org-legend {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-top: 3rem;
      padding: 1.5rem;
      background: var(--bg-card);
      border: 1px solid rgba(78, 250, 170, 0.1);
      border-radius: 8px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      color: var(--text-light);
    }

    .legend-box {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      border: 2px solid;
    }

    .legend-box.director {
      border-color: var(--accent-mint);
      background: rgba(78, 250, 170, 0.2);
    }

    .legend-box.department {
      border-color: var(--accent-teal);
      background: rgba(0, 163, 137, 0.1);
    }

    .legend-box.division {
      border-color: rgba(78, 250, 170, 0.3);
      background: transparent;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <div data-include="/components/header.html"></div>

  <!-- Navbar -->
  <div data-include="/components/navbar.html"></div>

  <section class="content">
    <div class="org-header">
      <h1><i class="fas fa-sitemap"></i> Organizational Chart</h1>
      <p>Site-89's hierarchical structure showing the chain of command and departmental organization.</p>
    </div>

    <div class="org-chart" id="orgChart">
      <!-- SVG for connecting lines -->
      <svg class="org-chart-lines" id="orgLines"></svg>

      <!-- Level 1: Site Director and Deputy -->
      <div class="org-level" data-level="1">
        <div class="org-position director" id="pos-site-director" data-children="pos-site-mgmt,pos-admin-dept">
          <div class="position-icon"><i class="fas fa-crown"></i></div>
          <div class="position-title">Site Director</div>
          <div class="position-name">Dr. Avery Rosewood</div>
          <div class="position-subtitle">Commander in Chief</div>
        </div>

        <div class="org-position director" id="pos-deputy-director" data-children="">
          <div class="position-icon"><i class="fas fa-user-tie"></i></div>
          <div class="position-title">Deputy Site Director</div>
          <div class="position-name">Killian Rehwald</div>
          <div class="position-subtitle">Second in Command</div>
        </div>
      </div>

      <!-- Level 2: Site Management Board -->
      <div class="org-level" data-level="2">
        <div class="org-position director" id="pos-site-mgmt" data-parent="pos-site-director">
          <div class="position-icon"><i class="fas fa-users-cog"></i></div>
          <div class="position-title">Site Management Board</div>
          <div class="position-name">Out of Character</div>
          <div class="position-subtitle">Administrative Oversight</div>
        </div>
      </div>

      <!-- Level 3: Administrative Department, Board of Executives, Board of Representatives -->
      <div class="org-level" data-level="3">
        <div class="org-position director" id="pos-admin-dept" data-parent="pos-site-director" data-children="pos-boe,pos-ad-hr,pos-ad-finance,pos-ad-media">
          <div class="position-icon"><i class="fas fa-briefcase"></i></div>
          <div class="position-title">Administrative Department</div>
          <div class="position-name">N/A</div>
          <div class="position-subtitle">Site Management</div>
          <div class="position-badge">AD</div>
        </div>
      </div>

      <!-- Level 4: Board of Exec, Board of Rep-->
    <div class="org-level" data-level="4">
        <div class="org-position director" id="pos-boe" data-parent="pos-admin-dept" data-children="pos-scd,pos-sd,pos-deo,pos-mtf,pos-ia,pos-md">
          <div class="position-icon"><i class="fas fa-users"></i></div>
          <div class="position-title">Board of Executives</div>
          <div class="position-name">Department Leadership</div>
          <div class="position-subtitle">Executive Committee</div>
        </div>
    </div>

      <!-- Level 4: Departments -->
      <div class="org-level" data-level="5">
        <div class="org-position department" id="pos-scd" data-parent="pos-boe" data-children="pos-scd-rnd,pos-scd-tsrd,pos-scd-md">
          <div class="position-icon"><i class="fas fa-flask"></i></div>
          <div class="position-title">Scientific Department</div>
          <div class="position-name">Kristen Fisher</div>
          <div class="position-subtitle">Research & Understanding</div>
          <div class="position-badge">ScD</div>
        </div>

        <div class="org-position department" id="pos-sd" data-parent="pos-boe" data-children="pos-sd-snc,pos-sd-sis,pos-sd-atra">
          <div class="position-icon"><i class="fas fa-lock"></i></div>
          <div class="position-title">Security Department</div>
          <div class="position-name">Alyx Andrews</div>
          <div class="position-subtitle">Site Protection</div>
          <div class="position-badge">SD</div>
        </div>

        <div class="org-position department" id="pos-mtf" data-parent="pos-boe" data-children="pos-mtf-alpha,pos-mtf-beta,pos-mtf-gamma">
          <div class="position-icon"><i class="fas fa-shield-alt"></i></div>
          <div class="position-title">Mobile Task Forces</div>
          <div class="position-name">Commander Meijer</div>
          <div class="position-subtitle">Specialized Response</div>
          <div class="position-badge">MTF</div>
        </div>

        <div class="org-position department" id="pos-ia" data-parent="pos-boe" data-children="pos-ia-oversight,pos-ia-raisa">
          <div class="position-icon"><i class="fas fa-user-shield"></i></div>
          <div class="position-title">Internal Affairs</div>
          <div class="position-name">Dir. Josiah Beck</div>
          <div class="position-subtitle">Oversight & Integrity</div>
          <div class="position-badge">IA</div>
        </div>

      <!-- Level 5: Divisions -->
      <div class="org-level" data-level="6">
        <!-- ScD Divisions -->
        <div class="org-position division" id="pos-scd-rnd" data-parent="pos-scd">
          <div class="position-icon"><i class="fas fa-dna"></i></div>
          <div class="position-title">Research and Development Division</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-scd-tsrd" data-parent="pos-scd">
          <div class="position-icon"><i class="fas fa-atom"></i></div>
          <div class="position-title">Theoretical Science Research Division</div>
          <div class="position-name">Dr. Natalie Anderson</div>
        </div>

        <div class="org-position division" id="pos-scd-md" data-parent="pos-scd">
          <div class="position-icon"><i class="fas fa-vial"></i></div>
          <div class="position-title">Medical Division</div>
          <div class="position-name">N/A</div>
        </div>

        <!-- SD Divisions -->
        <div class="org-position division" id="pos-sd-snc" data-parent="pos-sd">
          <div class="position-icon"><i class="fas fa-user-shield"></i></div>
          <div class="position-title">Security & Containment</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-sd-sis" data-parent="pos-sd">
          <div class="position-icon"><i class="fas fa-cube"></i></div>
          <div class="position-title">Security Intelligence Service</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-sd-atra" data-parent="pos-sd">
          <div class="position-icon"><i class="fas fa-walking"></i></div>
          <div class="position-title">Advanced Threat Response Administration</div>
          <div class="position-name">N/A</div>
        </div>

        <!-- MTF Divisions -->
        <div class="org-position division" id="pos-mtf-alpha" data-parent="pos-mtf">
          <div class="position-icon"><i class="fas fa-chess-rook"></i></div>
          <div class="position-title">Nu-7</div>
          <div class="position-name">"Hammer Down"</div>
        </div>

        <div class="org-position division" id="pos-mtf-beta" data-parent="pos-mtf">
          <div class="position-icon"><i class="fas fa-fire"></i></div>
          <div class="position-title">Epsilon-11</div>
          <div class="position-name">"Nine Tailed Fox"</div>
        </div>

        <!-- IA Divisions -->
        <div class="org-position division" id="pos-ia-oversight" data-parent="pos-ia">
          <div class="position-icon"><i class="fas fa-gavel"></i></div>
          <div class="position-title">Office of Compliance & Oversight</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-ia-raisa" data-parent="pos-ia">
          <div class="position-icon"><i class="fas fa-folder"></i></div>
          <div class="position-title">Recordskeeping and Information Security Administration</div>
          <div class="position-name">N/A</div>
        </div>

        <!-- AD Divisions -->
        <div class="org-position division" id="pos-ad-hr" data-parent="pos-ad">
          <div class="position-icon"><i class="fas fa-people-group"></i></div>
          <div class="position-title">Human Resources</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-ad-finance" data-parent="pos-ad">
          <div class="position-icon"><i class="fas fa-money-bill-trend-up"></i></div>
          <div class="position-title">Finance Division</div>
          <div class="position-name">N/A</div>
        </div>

        <div class="org-position division" id="pos-ad-media" data-parent="pos-ad">
          <div class="position-icon"><i class="fas fa-camera"></i></div>
          <div class="position-title">Media Division</div>
          <div class="position-name">N/A</div>
        </div>
      </div>

    <!-- Legend -->
    <div class="org-legend">
      <div class="legend-item">
        <div class="legend-box director"></div>
        <span>Site Leadership</span>
      </div>
      <div class="legend-item">
        <div class="legend-box department"></div>
        <span>Department Directors</span>
      </div>
      <div class="legend-item">
        <div class="legend-box division"></div>
        <span>Division Leaders</span>
      </div>
      <p>Note that this is not an exhaustive list, as positions higher, and between the Board of Executives do exist, and are not listed here. for more information see <a href="/departments/ad/">Administrative Department</a></p>
    </div>
  </section>

  <!-- Footer -->
  <div data-include="/components/footer.html"></div>

  <!-- Component Loading Script -->
  <script src="/assets/js/include.js"></script>

  <!-- Org Chart Line Drawing Script -->
  <script>
    class OrgChart {
      constructor(chartId, linesId) {
        this.chart = document.getElementById(chartId);
        this.svg = document.getElementById(linesId);
        this.positions = new Map();
        this.lines = new Map();
        
        this.init();
      }

      init() {
        // Collect all positions
        document.querySelectorAll('.org-position').forEach(pos => {
          this.positions.set(pos.id, {
            element: pos,
            parent: pos.dataset.parent,
            children: pos.dataset.children ? pos.dataset.children.split(',') : []
          });

          // Add hover listeners
          pos.addEventListener('mouseenter', () => this.highlightConnections(pos.id));
          pos.addEventListener('mouseleave', () => this.clearHighlights());
        });

        // Draw initial lines
        this.drawLines();

        // Redraw on window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(() => this.drawLines(), 100);
        });

        // Redraw after components load (header/footer might affect layout)
        setTimeout(() => this.drawLines(), 500);
      }

      drawLines() {
        // Clear existing lines
        this.svg.innerHTML = '';
        this.lines.clear();

        // Draw lines for each position that has a parent
        this.positions.forEach((data, id) => {
          if (data.parent && this.positions.has(data.parent)) {
            this.drawLine(data.parent, id);
          }
        });
      }

      drawLine(fromId, toId) {
        const fromEl = document.getElementById(fromId);
        const toEl = document.getElementById(toId);
        
        if (!fromEl || !toEl) return;

        const fromRect = fromEl.getBoundingClientRect();
        const toRect = toEl.getBoundingClientRect();
        const chartRect = this.chart.getBoundingClientRect();

        // Calculate positions relative to chart
        const x1 = fromRect.left + fromRect.width / 2 - chartRect.left;
        const y1 = fromRect.bottom - chartRect.top;
        const x2 = toRect.left + toRect.width / 2 - chartRect.left;
        const y2 = toRect.top - chartRect.top;

        // Create line element
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', x1);
        line.setAttribute('y1', y1);
        line.setAttribute('x2', x2);
        line.setAttribute('y2', y2);
        line.setAttribute('data-from', fromId);
        line.setAttribute('data-to', toId);

        this.svg.appendChild(line);

        // Store line reference
        const lineKey = `${fromId}-${toId}`;
        this.lines.set(lineKey, line);
      }

      highlightConnections(posId) {
        const toHighlight = new Set();
        const posData = this.positions.get(posId);
        
        if (!posData) return;

        // Add direct parent connection only
        if (posData.parent) {
          toHighlight.add(`${posData.parent}-${posId}`);
        }

        // Add direct children connections only
        posData.children.forEach(childId => {
          toHighlight.add(`${posId}-${childId}`);
        });

        // Highlight only directly connected lines
        this.lines.forEach((line, key) => {
          if (toHighlight.has(key)) {
            line.classList.add('highlighted', 'animated');
          }
        });
      }

      clearHighlights() {
        this.lines.forEach(line => {
          line.classList.remove('highlighted', 'animated');
        });
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        new OrgChart('orgChart', 'orgLines');
      });
    } else {
      new OrgChart('orgChart', 'orgLines');
    }
  </script>

</body>
</html>
