# Security headers for site89.github.io
# Aggressive protection against code inspection

<IfModule mod_headers.c>
  # Content Security Policy - Strict restrictions
  Header set Content-Security-Policy "default-src 'none'; script-src 'self' 'unsafe-inline' https://www.gstatic.com/firebasejs/ https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: https:; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' https://*.firebaseio.com https://*.firebase.com https://www.google-analytics.com; media-src 'self'; object-src 'none'; frame-ancestors 'none'; base-uri 'self'; form-action 'self';"

  # Prevent clickjacking
  Header set X-Frame-Options "DENY"

  # Prevent MIME sniffing
  Header set X-Content-Type-Options "nosniff"

  # Enable XSS protection
  Header set X-XSS-Protection "1; mode=block"

  # Referrer Policy
  Header set Referrer-Policy "strict-origin-when-cross-origin"

  # Feature Policy - Block all sensitive features
  Header set Permissions-Policy "geolocation=(), microphone=(), camera=(), payment=(), usb=(), magnetometer=(), gyroscope=(), accelerometer=(), vr=(), xr-spatial-tracking=()"

  # Prevent caching of sensitive pages
  Header set Cache-Control "no-store, no-cache, no-transform, must-revalidate, max-age=0, s-maxage=0"
  Header set Pragma "no-cache"
  Header set Expires "0"

  # Block source maps
  Header set X-Source-Map ""
  Header set SourceMap ""

  # Disable CORS
  Header set Access-Control-Allow-Origin "none"
</IfModule>

# Disable directory browsing
Options -Indexes

# Prevent access to sensitive files and directories
<FilesMatch "\.env|\.git|\.htaccess|firebase\.rules|config\.js|\.map|\.min\.js\.map">
  Order Allow,Deny
  Deny from all
</FilesMatch>

# Block common tool files
<FilesMatch "\.properties|\.gradle|Dockerfile|docker-compose\.yml">
  Order Allow,Deny
  Deny from all
</FilesMatch>

# Remove sensitive headers that might leak info
<IfModule mod_headers.c>
  Header unset Server
  Header unset X-Powered-By
  Header unset X-AspNet-Version
  Header unset X-Runtime
</IfModule>

