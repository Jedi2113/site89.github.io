<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pong â€” Site-89</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&family=Roboto:wght@300;400,500&family=Roboto+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Theme System -->
  <script type="module">
    import { ThemeManager } from '/assets/js/theme.js';
    ThemeManager.init();
  </script>

  <style>
    .page-hero { 
      padding: 2.5rem 1rem; 
      text-align:center; 
      background: linear-gradient(90deg, rgba(78,250,170,0.04), transparent); 
      border-bottom: 1px solid rgba(78,250,170,0.03); 
    }
    .page-hero .hero-title { 
      font-family: var(--font-head); 
      font-size: 2rem; 
      color: var(--accent-mint); 
      margin-bottom: 0.35rem; 
    }
    .page-hero .hero-sub { 
      color: var(--text-light); 
      opacity: 0.9; 
    }

    .game-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      padding: 2rem 1rem;
    }

    #gameCanvas {
      border: 3px solid var(--accent-mint);
      border-radius: 8px;
      background: #0a1612;
      box-shadow: 0 0 30px rgba(78, 250, 170, 0.3);
      max-width: 100%;
      touch-action: none;
    }

    .game-controls {
      display: flex;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
    }

    .game-btn {
      padding: 0.8rem 1.5rem;
      background: var(--accent-mint);
      color: #06100e;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1rem;
      transition: all 0.2s ease;
    }

    .game-btn:hover {
      background: var(--accent-teal);
      transform: scale(1.05);
    }

    .game-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: scale(1);
    }

    .score-display {
      font-size: 1.5rem;
      color: var(--accent-mint);
      font-weight: 700;
      font-family: 'Courier New', monospace;
      display: flex;
      gap: 3rem;
      align-items: center;
    }

    .player-score {
      text-align: center;
    }

    .player-score .label {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 0.3rem;
    }

    .game-info {
      text-align: center;
      color: var(--text-light);
      max-width: 600px;
      line-height: 1.6;
    }

    .game-over {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--bg-card);
      border: 3px solid var(--accent-mint);
      border-radius: 12px;
      padding: 2rem;
      text-align: center;
      z-index: 1000;
      box-shadow: 0 0 50px rgba(78, 250, 170, 0.4);
      min-width: 300px;
    }

    .game-over.active {
      display: block;
    }

    .game-over h2 {
      color: var(--accent-mint);
      margin-top: 0;
      font-size: 2rem;
    }

    .game-over .winner {
      font-size: 1.5rem;
      color: var(--text-light);
      margin: 1rem 0;
    }

    .difficulty-selector {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      justify-content: center;
    }

    .diff-btn {
      padding: 0.5rem 1rem;
      background: rgba(78, 250, 170, 0.1);
      border: 2px solid rgba(78, 250, 170, 0.3);
      border-radius: 6px;
      color: var(--text-light);
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .diff-btn.active {
      background: var(--accent-mint);
      color: #06100e;
      border-color: var(--accent-mint);
    }

    .diff-btn:hover {
      border-color: var(--accent-mint);
    }
  </style>
</head>
<body>
  <div data-include="/components/header.html"></div>
  <div data-include="/components/navbar.html"></div>

  <section class="page-hero">
    <div class="hero-title"><i class="fa-solid fa-table-tennis-paddle-ball" style="margin-right:0.5rem;"></i>Pong</div>
    <div class="hero-sub">Classic arcade action for personnel downtime</div>
  </section>

  <section class="content">
    <div class="game-container">
      <div class="difficulty-selector">
        <button class="diff-btn active" onclick="setDifficulty('easy')">Easy</button>
        <button class="diff-btn" onclick="setDifficulty('medium')">Medium</button>
        <button class="diff-btn" onclick="setDifficulty('hard')">Hard</button>
      </div>

      <div class="score-display">
        <div class="player-score">
          <div class="label">Player</div>
          <div id="playerScore">0</div>
        </div>
        <div style="color:var(--text-light);opacity:0.5;">-</div>
        <div class="player-score">
          <div class="label">AI</div>
          <div id="aiScore">0</div>
        </div>
      </div>
      
      <canvas id="gameCanvas" width="800" height="600"></canvas>
      
      <div class="game-controls">
        <button id="startBtn" class="game-btn"><i class="fa-solid fa-play" style="margin-right:0.5rem;"></i>Start Game</button>
        <button id="resetBtn" class="game-btn"><i class="fa-solid fa-rotate-right" style="margin-right:0.5rem;"></i>Reset</button>
      </div>

      <div class="game-info">
        <p><strong>Objective:</strong> First to 5 points wins! Use your mouse or touch to move your paddle and deflect the ball.</p>
        <p style="opacity:0.8;font-size:0.9rem;">Move your paddle by moving your mouse up and down on the canvas, or use touch/drag on mobile devices.</p>
      </div>
    </div>
  </section>

  <div id="gameOver" class="game-over">
    <h2>Game Over!</h2>
    <div class="winner" id="winnerText">Player Wins!</div>
    <button class="game-btn" onclick="restartGame()">Play Again</button>
  </div>

  <div data-include="/components/footer.html"></div>

  <script src="/assets/js/include.js"></script>
  <script type="module" src="/assets/js/auth.js"></script>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const playerScoreEl = document.getElementById('playerScore');
    const aiScoreEl = document.getElementById('aiScore');
    const winnerTextEl = document.getElementById('winnerText');
    const gameOverEl = document.getElementById('gameOver');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');

    // Game settings
    const paddleWidth = 10;
    const paddleHeight = 100;
    const ballSize = 10;
    const winningScore = 5;
    
    // Game state
    let playerY = canvas.height / 2 - paddleHeight / 2;
    let aiY = canvas.height / 2 - paddleHeight / 2;
    let ballX = canvas.width / 2;
    let ballY = canvas.height / 2;
    let ballSpeedX = 5;
    let ballSpeedY = 5;
    let playerScore = 0;
    let aiScore = 0;
    let gameRunning = false;
    let gameLoop = null;
    let difficulty = 'easy';
    let aiSpeed = 4;

    // Mouse/Touch tracking
    let mouseY = canvas.height / 2;

    canvas.addEventListener('mousemove', (e) => {
      const rect = canvas.getBoundingClientRect();
      mouseY = e.clientY - rect.top;
    });

    canvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      const rect = canvas.getBoundingClientRect();
      mouseY = e.touches[0].clientY - rect.top;
    });

    window.setDifficulty = function(diff) {
      difficulty = diff;
      document.querySelectorAll('.diff-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      switch(diff) {
        case 'easy': aiSpeed = 3; break;
        case 'medium': aiSpeed = 5; break;
        case 'hard': aiSpeed = 7; break;
      }
    };

    function drawGame() {
      // Clear canvas
      ctx.fillStyle = '#0a1612';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Draw center line
      ctx.strokeStyle = 'rgba(78, 250, 170, 0.2)';
      ctx.lineWidth = 2;
      ctx.setLineDash([10, 10]);
      ctx.beginPath();
      ctx.moveTo(canvas.width / 2, 0);
      ctx.lineTo(canvas.width / 2, canvas.height);
      ctx.stroke();
      ctx.setLineDash([]);

      // Draw player paddle (left)
      ctx.fillStyle = '#4efaaa';
      ctx.shadowBlur = 10;
      ctx.shadowColor = '#4efaaa';
      ctx.fillRect(20, playerY, paddleWidth, paddleHeight);
      ctx.shadowBlur = 0;

      // Draw AI paddle (right)
      ctx.fillStyle = '#ff6b6b';
      ctx.shadowBlur = 10;
      ctx.shadowColor = '#ff6b6b';
      ctx.fillRect(canvas.width - 20 - paddleWidth, aiY, paddleWidth, paddleHeight);
      ctx.shadowBlur = 0;

      // Draw ball
      ctx.fillStyle = '#ffffff';
      ctx.shadowBlur = 15;
      ctx.shadowColor = '#ffffff';
      ctx.fillRect(ballX - ballSize / 2, ballY - ballSize / 2, ballSize, ballSize);
      ctx.shadowBlur = 0;

      if (!gameRunning) return;

      // Update player paddle
      const targetY = mouseY - paddleHeight / 2;
      const paddleSpeed = 8;
      if (Math.abs(playerY - targetY) > paddleSpeed) {
        playerY += (targetY - playerY) / paddleSpeed;
      } else {
        playerY = targetY;
      }
      playerY = Math.max(0, Math.min(canvas.height - paddleHeight, playerY));

      // Update AI paddle
      const aiCenter = aiY + paddleHeight / 2;
      if (ballX > canvas.width / 2) { // Only track when ball is on AI's side
        if (aiCenter < ballY - 35) {
          aiY += aiSpeed;
        } else if (aiCenter > ballY + 35) {
          aiY -= aiSpeed;
        }
      }
      aiY = Math.max(0, Math.min(canvas.height - paddleHeight, aiY));

      // Update ball
      ballX += ballSpeedX;
      ballY += ballSpeedY;

      // Ball collision with top/bottom
      if (ballY <= 0 || ballY >= canvas.height) {
        ballSpeedY = -ballSpeedY;
      }

      // Ball collision with player paddle
      if (ballX <= 30 + paddleWidth && ballY >= playerY && ballY <= playerY + paddleHeight) {
        ballSpeedX = Math.abs(ballSpeedX) * 1.05;
        const hitPos = (ballY - playerY) / paddleHeight - 0.5;
        ballSpeedY += hitPos * 3;
      }

      // Ball collision with AI paddle
      if (ballX >= canvas.width - 30 - paddleWidth && ballY >= aiY && ballY <= aiY + paddleHeight) {
        ballSpeedX = -Math.abs(ballSpeedX) * 1.05;
        const hitPos = (ballY - aiY) / paddleHeight - 0.5;
        ballSpeedY += hitPos * 3;
      }

      // Scoring
      if (ballX < 0) {
        aiScore++;
        aiScoreEl.textContent = aiScore;
        if (aiScore >= winningScore) {
          endGame('AI Wins!');
        } else {
          resetBall();
        }
      } else if (ballX > canvas.width) {
        playerScore++;
        playerScoreEl.textContent = playerScore;
        if (playerScore >= winningScore) {
          endGame('Player Wins!');
        } else {
          resetBall();
        }
      }
    }

    function resetBall() {
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX = (Math.random() > 0.5 ? 1 : -1) * 5;
      ballSpeedY = (Math.random() - 0.5) * 8;
    }

    function startGame() {
      if (gameRunning) return;
      
      gameRunning = true;
      startBtn.disabled = true;
      
      resetBall();
      gameLoop = setInterval(drawGame, 1000 / 60);
    }

    function resetGame() {
      clearInterval(gameLoop);
      gameRunning = false;
      playerScore = 0;
      aiScore = 0;
      playerScoreEl.textContent = playerScore;
      aiScoreEl.textContent = aiScore;
      startBtn.disabled = false;
      gameOverEl.classList.remove('active');
      
      playerY = canvas.height / 2 - paddleHeight / 2;
      aiY = canvas.height / 2 - paddleHeight / 2;
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX = 5;
      ballSpeedY = 5;
      
      drawGame();
    }

    function endGame(winner) {
      clearInterval(gameLoop);
      gameRunning = false;
      winnerTextEl.textContent = winner;
      gameOverEl.classList.add('active');
    }

    function restartGame() {
      resetGame();
      startGame();
    }

    window.restartGame = restartGame;

    // Button events
    startBtn.addEventListener('click', startGame);
    resetBtn.addEventListener('click', resetGame);

    // Initialize
    resetGame();
  </script>

</body>
</html>
